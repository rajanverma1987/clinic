1. Global Compliance Architecture
1.1 Data handling

• AES-256 at rest, TLS 1.3 in transit
• Field-level encryption for PHI (diagnosis, notes, prescriptions)
• Per-region data residency (EU, US, APAC, India, Middle East)
• Data-retention policies (delete/archive after X years by region)
• Configurable consent capture for each jurisdiction
• Daily encrypted backups stored in same region

1.2 Access control

• RBAC + ABAC
• Device/IP tracking
• Auto session expiry
• Forced logout on password change
• Per-role visibility rules for PHI
• Offline export permissions with audit trail

1.3 Audit + monitoring

• Immutable audit logs for every read/write
• Exportable HIPAA-style access reports
• Intrusion detection + anomaly alerts
• Rate limiting + bot detection
• External logging to SIEM-compatible system

2. Region-Specific Regulations
2.1 United States – HIPAA

• Signed BAA with hosting
• PHI access logs retained for 6 years
• Emergency access workflow
• Secure messaging (no raw PHI in SMS/Email)
• Automatic breach-notification generator

2.2 Europe – GDPR

• Lawful basis (consent/legitimate interest)
• Data portability in machine-readable format
• Data erasure workflows
• Country-level DPA template
• Cookie and tracking compliance

2.3 Canada – PIPEDA

• Breach notification triggers
• Clear data-use purposes
• Patient access records panel

2.4 Australia – Privacy Act

• Local storage for clinical notes
• Consent for data sharing across clinics

2.5 Middle East (UAE, Saudi), India

• Data-localization options
• Explicit consent for processing medical data
• E-signature compliance for prescriptions where allowed

3. Medical Content Standardization
3.1 Coding

• ICD-10 diagnosis codes
• SNOMED CT for clinical terminology
• LOINC for labs (optional)
• FHIR-ready architecture for future integrations

3.2 Prescription rules

• Country-specific prescription layouts
• Legally required fields per region
• E-prescription signature rules
• Drug interactions lookup (future module)

3.3 Clinical records

• SOAP notes
• Templates per specialty
• Attachment support (PDF, images, lab files)

4. Financial Compliance
4.1 Payments

• PCI-DSS compliant gateways only
• Multi-currency support
• Country-specific tax configuration (GST, VAT)
• Itemized invoices with legal formatting
• Settlement reports per provider

4.2 Subscription billing

• Regional pricing
• Tax-inclusive/exclusive display
• Compliance invoices for SaaS (reverse charge, VAT ID)

5. Operational Reliability
5.1 High availability

• Multi-zone deployment
• Auto-scaling API layer
• Read replicas for high-traffic clinics

5.2 Disaster recovery

• RPO ≤ 15 min
• RTO ≤ 1 hour
• Cross-region backups
• Integrity checks daily

5.3 Change management

• Release logs
• Audit of configuration changes
• Backwards-compatible schema migrations


6. Product Feature Blueprint
6.1 Patient Flow

• Registration
• Visit history
• Appointment booking (walk-in + online)
• Automated reminders (SMS/Email/WhatsApp)
• Queue management with live wait times

6.2 Doctor Tools

• SOAP notes
• Templates
• Prescriptions
• Lab orders
• Follow-up reminders

6.3 Billing

• OPD billing
• Procedure billing
• Discounts and insurance fields
• UPI/card payments
• Daily settlement

6.4 Inventory

• Medicine stock
• Batch/expiry
• Auto low-stock alerts
• Supplier management

6.5 Staff

• Roles/permissions
• Attendance
• Task list

6.6 Marketing + engagement

• Post-visit feedback
• Automated follow-ups
• Broadcast campaigns (regionally compliant)

6.7 Intelligence

• Revenue analytics
• Recurrence reports
• Expense tracking
• Inventory predictions

6.8 Multi-location

• Shared patient profiles
• Centralized reports
• Clinic-level permissions

6.9 Telemedicine

• Video calls
• Secure chat
• Disclaimers per region

7. Privacy & Security UX

• Consent screen at onboarding
• Patient privacy center
• Expiring share links for reports
• Role-based visibility for sensitive notes
• Localized legal pages

8. Legal Documents You’ll Need

• Privacy Policy
• Terms of Service
• DPA (Data Processing Agreement)
• HIPAA BAA (for US clients)
• GDPR-compliant cookie policy
• Incident response policy
• Data retention policy
• Medical disclaimer per country


9. Engineering Architecture (Forward-looking)
9.1 Backend

• Node.js / .NET Core / Java Spring (your choice)
• PostgreSQL with row-level security
• Redis for tokens & rate limits
• Object storage for medical files
• Event-based architecture for notifications

9.2 Frontend

• Next.js for web
• Multi-language (i18n)
• Offline notes draft mode

9.3 Infrastructure

• Kubernetes
• Terraform for provisioning
• S3-compatible encrypted storage
• Cloudflare WAF
• Zero-trust access for internal dashboards

9.4 Integrations

• Google Calendar
• SMS gateways (regional)
• Local payment gateways
• FHIR-based hospital systems

1. System Goals

• Build a global-ready clinic management SaaS.
• Everything must support multi-tenant, multi-clinic, multi-region.
• Architecture must support regional compliance (HIPAA, GDPR, etc.).
• All modules must be API-first for future mobile apps.

2. Tenancy Model

• Use multi-tenant architecture with tenant_id on all tables.
• Each clinic = one tenant.
• Users belong to a tenant and have roles.
• All DB queries must be filtered by tenant_id.
• Row-Level Security (RLS) can be enabled for extra safety.
• Configuration fields (currency, locale, timezone, tax rules) stored in tenant_settings table.

3. Core Modules (with Cursor coding instructions)
3.1 Patient Module

• CRUD patients.
• Fields: demographics, contact info, identifiers.
• Attachments allowed (reports, files).
• Full audit tracking.
• Paginated list + filters.
Cursor instruction: auto-generate REST endpoints, validation schemas, pagination helpers.

3.2 Appointments

• Booking, rescheduling, cancellation.
• Multiple statuses (scheduled, arrived, in_queue, completed, cancelled).
• Reminder scheduler queues messages.
Cursor instruction: event-driven logic for reminders; background worker integration.

3.3 Queue / Walk-in

• Realtime queue.
• Websocket or SSE for updates.
• Clinic-level configuration for display order.
Cursor instruction: provide reusable Socket manager and publish/subscribe events.

3.4 Clinical Notes

• SOAP note structure.
• Custom templates per doctor.
• Versioning of notes.
Cursor instruction: generate modular components for text sections + dynamic templates.

3.5 Prescriptions

• Drug list + frequencies + durations.
• Printable + exportable.
• Country-specific layout (dynamic).
Cursor instruction: create template renderer that takes country_code and prescription schema.

3.6 Billing

• Invoice creation.
• Items: consultation, procedure, medication.
• Localized tax logic.
Cursor instruction: abstract tax engine per country; keep invoice model normalized.

3.7 Inventory

• Medicines + batches + expiry.
• Auto low-stock triggers.
Cursor instruction: scheduled job daily to evaluate stock thresholds.

3.8 Staff / Roles

• Role-based access control.
• Attribute-based rules (doctor can only see own patients).
Cursor instruction: centralized middleware for permission checks and resource scopes.

3.9 Telemedicine

• Video using any standard provider.
• Session logs (no PHI in transcripts).
Cursor instruction: generate API with ephemeral tokens, short-lived URLs.

3.10 Reporting

• Revenue, patient count, recurrence.
• Export CSV/PDF.
Cursor instruction: build a reporting service wrapper with query builder patterns.

4. Internationalization Model
Language

• String dictionaries.
• Server responses localized using tenant locale.

Currency

• currency_code stored in tenant_settings.
• Money always stored in minor units (integer).

Timezones

• All timestamps stored as UTC.
• UI converts based on tenant timezone.

Country Variants

• Prescription formats
• Invoice formats
• TTL for records
• Required compliance fields

Cursor instruction: use strategy pattern for region-specific implementations.

5. Compliance & Security Layer
Mandatory Enforcement

• All API routes behind authentication.
• JWT with rotation.
• Refresh token stored HTTP-only.
• PHI fields encrypted using field-level encryption.
• Audit logs for: read, write, delete.
• Access logs retained per region rules.

GDPR/HIPAA Hooks

• Data-export endpoint per patient.
• Delete/anonymize endpoint.
• Consent record stored each time data is processed.
• Configurable retention schedule.

Cursor instruction: generate middleware for:
– audit_write(resource, resource_id, user)
– audit_read(resource, resource_id, user)
– encryptField/decryptField handlers
– tenant access validation

6. Multi-Clinic Architecture
Cross-clinic logic

• Shared master admin panel.
• Clinic admins limited to tenant scope.
• Reports aggregated optionally by parent organization.

Cursor instruction: namespace all tenant and clinic queries to avoid accidental leakage.